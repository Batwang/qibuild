Getting Started
===============


In this tutorial, you will learn how to configure and build a
C++ project using the QiBuild framework.


Requirements
------------


Python 2.7 is the preferred version, but QiBuild should work
fine on python 2.6, too.

CMake version 2.8.3 is the preferred version, but you should
not have any problem with CMake 2.6.

Be sure PYTHONPATH is set to /path/to/qibuild/python and
that  qibuild (from /path/to/qibuild/bin/qibuild) is in PATH.



Creating a work tree
--------------------


First you need to chose a qibuild "worktree".

This path will be searched by qibuild to find the sources
of your pojects.

For the following, we call this worktree QI_WORK_TREE

Then go to this directory and run:

[source, bash]
----
qibuild init
----

This will create a new qibuild configuration file in
your working directory, in QI_WORK_TREE/.qi/build.cfg


Configuring QiBuild
-------------------

You can skip this section if you want to build with Unix Makefiles.

If it is not the case, you will have to edit the configuration file
QI_WORK_TREE/.qi/build.cfg

The configuration file can also be generated by using:

[source, bash]
----
qibuild init --interactive
----

and then answering the questions

Configuring QiBuild for Visual Studio
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You will have to do several things for qibuild to work with
visual studio.

* Set environment variables (%PATH%, %LIBDIR%, etc.)
You can use the .bat script provided with Visual Studio.

For Visual Studio 2008, the script location looks liken:
+c:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat+

(Precise path can be found in the start menu, it is labeled
"Visual Studio Command Prompt)

* Make sure CMake is in the %PATH%.

* Make sure CMake uses the proper generator.

Here's what a complete .qi/build.cfg would look like
to use Visual Studio 2008:


[source, ini]
----
[general "env"]
  path = C:\Program Files\CMake 2.8\bin;
  bat_file = c:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat

[general "build"]
  cmake_generator = "Visual Studio 9 2008"
----

Configuring QiBuild for MinGWin
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You will have to do several things for qibuild to work with
MinGW.

* Set PATH properly so that make.exe and gcc.exe are found

* Make sure CMake uses the correct generator,

Here's what a complete .qi/build.cfg would look like to use
MinGWin:

[source, ini]
----
[general "env"]
path = C:\Mingw\bin;C:\MinGW\msys\1.0\bin;

[general "build"]
  cmake_generator = "Unix Makefiles"
----


Creating a new project
----------------------


You can then create a new project:

[source, bash]
----
qibuild create-new-proj foo
----

This will create a new project in QI_WORK_TREE/foo.

Let's have a look of what has been generated:

[source, bash]
----
foo
|__  CMakeLists.txt
|__  main.cpp
|__  qibuild.cmake
|__  qibuild.manifest
----


* main.cpp is just a standard "Hello World"

* CMakeLists.txt : this is a script file that will be read by CMake to generate
makefiles, or Visual Studio solutions.

* qibuild.cmake : this file MUST be included for CMake to find the qibuild/cmake
framework

* qibuild.manifest : this file MUST be present for qibuild to know how to build the
foo project.




Configuring, building and testing your new project
--------------------------------------------------


Configuring the foo project is done by:
[source, bash]
----
qibuild configure foo
----

This command may be used anywhere under the QI_WORK_TREE directory.

You can also use:

[source, bash]
----
qibuild configure
----

without specifying "foo" if you are anywhere under the foo directory


This will create a build directory in QI_WORK_TREE/foo/build,
and run cmake in this build directory.

(The name of the build directory reflects your plateform and your
configuration, so that you can use different build configurations
wit the same source tree)

Then run:
[source, bash]
----
qibuild make foo
qibuild tests foo
----

This will compile and launch tests on the foo project.




